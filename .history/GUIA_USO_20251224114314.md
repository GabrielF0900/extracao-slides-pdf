# ğŸ“˜ Guia de Uso - ExtraÃ§Ã£o de Slides para PDF

## ğŸš€ PreparaÃ§Ã£o Inicial

### 1ï¸âƒ£ **Instale as DependÃªncias**

```powershell
pip install -r requirements.txt
```

Ou instale manualmente:
```powershell
pip install pyautogui keyboard img2pdf pygetwindow Pillow
```

### 2ï¸âƒ£ **Configure o Corte (Crop) - IMPORTANTE!**

Abra o arquivo `extrair.py` e ajuste estas variÃ¡veis **no topo** de acordo com seu monitor:

```python
CORTE_TOPO = 160    # Aumentar: remove mais abas/barra de endereÃ§o
CORTE_BAIXO = 20    # Aumentar: remove mais barra de status
CORTE_LADOS = 10    # Aumentar: remove mais bordas laterais
```

> **Teste rÃ¡pido:** Tire 1 ou 2 prints de teste. Se cortar o conteÃºdo, ajuste os valores incrementando.

## ğŸ¬ Como Usar

### **OpÃ§Ã£o 1: Windows (FÃ¡cil) ğŸ–±ï¸**

Clique duas vezes em `extrair_python.bat`:
- Abre automaticamente o script
- Sem necessidade de terminal
- Pausa ao final para vocÃª ver os resultados

### **OpÃ§Ã£o 2: Terminal/PowerShell**

```powershell
python extrair.py
```

---

## ğŸ“‹ Passos da ExecuÃ§Ã£o

### Passo 1ï¸âƒ£ : Digite o Nome do Arquivo
O script pedirÃ¡ um nome para o PDF:
```
>> Digite o NOME do arquivo: Aula_Historia_Slide_01
```
- **Deixe em branco** para usar um nome padrÃ£o com timestamp
- Caracteres especiais sÃ£o removidos automaticamente (/, \, :, ?, ", etc)
- ExtensÃ£o `.pdf` Ã© adicionada automaticamente

### Passo 2ï¸âƒ£ : Escolha a Pasta de Destino
```
Onde deseja salvar? (Deixe em branco para salvar na pasta atual)
>> Cole o CAMINHO da pasta: C:\Users\seu_usuario\Desktop\Material
```
- **Deixe em branco** para salvar na pasta do script
- Se a pasta nÃ£o existir, salva na pasta atual como proteÃ§Ã£o

### Passo 3ï¸âƒ£ : Ative a Janela do Navegador
- O script **contarÃ¡ 3 segundos em contagem regressiva**
- **Clique RÃPIDO** na janela do navegador durante a contagem
- O script entÃ£o detectarÃ¡ e focarÃ¡ nessa janela
- **Dica:** Maximiza a janela do navegador para melhor resultado

### Passo 5ï¸âƒ£ : Gere o PDF

Quando terminar de capturar:

**Pressione: `ESC`**

O script farÃ¡:
```
Encerrando captura...
Gerando PDF em: C:\... âœ…

âœ… SUCESSO! Arquivo criado:
C:\Users\seu_usuario\Desktop\Material\Aula_Historia_Slide_01.pdf
```

### Passo 6ï¸âƒ£ : Escolha o que Fazer

ApÃ³s gerar o PDF com sucesso, vocÃª verÃ¡ um menu de finalizaÃ§Ã£o:

```
#########################################
        PROCESSO FINALIZADO! O QUE DESEJA FAZER?
#########################################
 [ENTER]   -> ComeÃ§ar um NOVO arquivo (Aperte Enter)
 [SAIR]    -> Digite SAIR e dÃª Enter para fechar
#########################################
>> 
```

#### OpÃ§Ã£o 1: ComeÃ§ar um Novo Arquivo
- Simplesmente **pressione ENTER**
- O programa volta ao inÃ­cio para processar outro PDF
- VocÃª pode digitarÃ¡ um novo nome de arquivo e uma nova pasta de destino

#### OpÃ§Ã£o 2: Sair da AplicaÃ§Ã£o
- **Digite: `SAIR`** (com letras maiÃºsculas)
- Pressione **ENTER**
- A aplicaÃ§Ã£o fecharÃ¡ com a mensagem: `"Fechando aplicaÃ§Ã£o... AtÃ© a prÃ³xima!"`

---

## âœ… PRONTO!

Seu PDF estÃ¡ gerado e pronto para usar! ğŸ‰

## ğŸ“‹ O que o Script Faz

âœ… **Captura automÃ¡tica de slides:**
- Detecta a janela ativa automaticamente
- Remove bordas, abas e menus (baseado na configuraÃ§Ã£o de crop)
- Salva cada frame como imagem PNG em pasta temporÃ¡ria

âœ… **Cria pasta temporÃ¡ria:**
- Cria uma pasta `temp_[nome_do_arquivo]` para organizar as imagens
- Imagens tÃªm nome `slide_001.png`, `slide_002.png`, etc.
- Timestamp adicionado para evitar duplicatas

âœ… **Converte para PDF:**
- Agrupa todas as imagens em ordem numÃ©rica
- MantÃ©m qualidade original
- NomeaÃ§Ã£o segura (remove caracteres invÃ¡lidos do Windows)

âœ… **ProteÃ§Ã£o de falhas:**
- Se houver erro ao salvar, cria um backup automÃ¡tico na pasta atual
- Pasta temporÃ¡ria com imagens Ã© mantida (para recuperaÃ§Ã£o manual se necessÃ¡rio)

## ğŸ“ Estrutura de Arquivos

ApÃ³s executar e capturar slides:
```
C:\Users\gabri\OneDrive\Desktop\Projetos\Extracao\
â”œâ”€â”€ extrair.py
â”œâ”€â”€ extrair_python.bat
â”œâ”€â”€ GUIA_USO.md
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ LICENSE
â”‚
â”œâ”€â”€ temp_Aula_Historia_Slide_01/  â† PASTA TEMPORÃRIA
â”‚   â”œâ”€â”€ slide_001_123456.png
â”‚   â”œâ”€â”€ slide_002_123457.png
â”‚   â”œâ”€â”€ slide_003_123458.png
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ Aula_Historia_Slide_01.pdf  â† PDF FINAL (gerado aqui ou na pasta escolhida)
```

## ğŸ’¡ Dicas e Boas PrÃ¡ticas

### â­ Antes de ComeÃ§ar
1. âœ… **Maximiza o navegador** - Melhor qualidade de captura
2. âœ… **Fecha notificaÃ§Ãµes** - Para nÃ£o aparecer no PDF
3. âœ… **Deixa a pÃ¡gina carregar** - Aguarde 2-3 segundos antes de comeÃ§ar
4. âœ… **Testa com 2-3 slides** - Para calibrar o crop corretamente

### â±ï¸ Durante a Captura
1. **Ritmo:** Use `ENTER` rapidamente entre slides
2. **Espera:** Se o slide demorar, espere antes de capturar
3. **NavegaÃ§Ã£o:** Use setas do teclado ou scroll conforme necessÃ¡rio

### ğŸ“Š PÃ³s-Captura
- **PDF gerado:** Abra e verifique a qualidade
- **Pasta temporÃ¡ria:** Pode deletar manualmente apÃ³s confirmar o PDF
- **Reutilizar imagens:** As imagens estÃ£o em `temp_[nome]` se precisar

## ğŸ”§ PersonalizaÃ§Ãµes (AvanÃ§ado)

### Aumentar Qualidade da Captura

Se as imagens ficarem pequenas, tente maximizar ainda mais o navegador ou use monitores em 4K.

### Deletar Pasta TemporÃ¡ria Automaticamente

Abra `extrair.py` e procure por:
```python
# ATENÃ‡ÃƒO: Se quiser deletar a pasta temp automaticamente apÃ³s terminar,
# descomente as linhas abaixo. Por padrÃ£o, deixei mantendo a pasta conforme seu pedido de 'backup'.
# import shutil
# shutil.rmtree(pasta_temp_dinamica)
```

Descomente (remova o `#`) para deletar a pasta automaticamente apÃ³s gerar o PDF.

## âŒ Resolvendo Problemas

| Problema | SoluÃ§Ã£o |
|----------|---------|
| **PDF vazio ou preto** | Aumente `CORTE_TOPO`. O script pode estar capturando acima/abaixo da janela. Tente `CORTE_TOPO = 180` |
| **Corta o conteÃºdo das bordas** | Aumente `CORTE_LADOS`. Tente `CORTE_LADOS = 20` |
| **Aparece a barra de endereÃ§o** | Diminua `CORTE_TOPO`. Tente `CORTE_TOPO = 140` |
| **Captura a janela errada** | Clique no navegador **durante** a contagem de 3 segundos |
| **"ModuleNotFoundError"** | Execute `pip install -r requirements.txt` novamente |
| **Nada acontece ao pressionar ENTER** | A janela do navegador pode nÃ£o estar ativa. Clique nela e tente novamente |
| **PDF muito lento para gerar** | Muitas imagens (500+). Pode demorar alguns minutos. Seja paciente! |
| **"Permission denied" ao salvar** | A pasta de destino estÃ¡ aberta no explorador. Feche e tente novamente |

## ğŸ¯ Workflow Recomendado (Passo a Passo)

```
1. Abra seu navegador com os slides/conteÃºdo
2. Execute: python extrair.py (ou clique em extrair_python.bat)
3. Digite o nome: "Aula_02_Parte_01"
4. Deixe a pasta em branco (salva aqui)
5. Clique no navegador durante a contagem (3, 2, 1...)
6. Comece capturando: ENTER
7. Navegue para o prÃ³ximo slide
8. Capture: ENTER
9. Repita atÃ© o Ãºltimo slide
10. Pressione: ESC
11. Aguarde alguns segundos...
12. âœ… PDF pronto em: Aula_02_Parte_01.pdf
```

## ğŸ“ InformaÃ§Ãµes TÃ©cnicas

- **Linguagem:** Python 3.8+
- **DependÃªncias:** PyAutoGUI, Keyboard, Img2Pdf, PyGetWindow, Pillow
- **Tamanho do PDF:** Varia conforme quantidade de slides (mÃ©dia 2-5 MB por 10 slides)
- **Sistema:** Windows (compatÃ­vel com PowerShell e CMD)
- **Tempo de processamento:** ~2 segundos por slide capturado + ~10 segundos para gerar PDF

## ğŸ“ Suporte

Se tiver problemas, verifique:
- âœ… Python 3.8+ instalado: `python --version`
- âœ… DependÃªncias instaladas: `pip list | findstr pyautogui`
- âœ… PermissÃµes de pasta (nÃ£o em pasta protegida)
- âœ… Windows Defender/AntivÃ­rus nÃ£o bloqueando PyAutoGUI

**Desenvolvido por Gabriel FalcÃ£o** | MIT License
